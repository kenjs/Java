<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE sqlMap   
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"   
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="com.cy.bggl.dao.BusBghyxmMapper">
	<select id="selectBgHyxmPage" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgHyxmDomain">
		SELECT A.HYXM_DJXH AS hyxmDjxh,
		       A.JGBM AS jgbm,
		       B.JC AS jgmc,
		       A.FBRQ AS fbrq,
		       A.BCZT_DM AS bcztDm,
		       A.ZT AS zt,
		       A.XJGXBZ AS xjgxbz,
		       A.CJR_CZY_DJXH AS cjrCzyDjxh,
		       A.CJRQ AS cjrq,
		       A.XGR_CZY_DJXH AS xgrCzyDjxh,
		       A.XGRQ AS xgrq,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.CJR_CZY_DJXH) cjrMc,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.XGR_CZY_DJXH) xgrMc
		  FROM BG_HYXM A ,QY_ZZJG B
		  WHERE A.JGBM=B.JGBM 
		  	AND A.YXBZ='Y'  
		  <dynamic> 
			<isNotEmpty property="cjrCzyDjxh" prepend="and">
				A.CJR_CZY_DJXH = #cjrCzyDjxh#
			</isNotEmpty>
			<isNotEmpty property="zt" prepend="and">
				A.ZT LIKE #zt#
			</isNotEmpty>
			<isNotEmpty property="rqQ" prepend="AND">
		  		A.CJRQ >= TO_DATE(#rqQ#,'yyyy-MM-dd')
		  	</isNotEmpty>
		  	<isNotEmpty property="rqZ" prepend="AND">
		  		A.CJRQ &lt; TO_DATE(#rqZ#,'yyyy-MM-dd')+1
		  	</isNotEmpty>
		  </dynamic>
		  $orderStr$
    </select>
    
    <select id="selectBgHyxmAll" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgHyxmDomain">
		SELECT A.HYXM_DJXH AS hyxmDjxh,
		       A.JGBM AS jgbm,
		        B.JC AS jgmc,
		       A.FBRQ AS fbrq,
		       A.BCZT_DM AS bcztDm,
		       A.ZT AS zt,
		       A.XJGXBZ AS xjgxbz,
		       A.CJR_CZY_DJXH AS cjrCzyDjxh,
		       A.CJRQ AS cjrq,
		       A.XGR_CZY_DJXH AS xgrCzyDjxh,
		       A.XGRQ AS xgrq,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.CJR_CZY_DJXH) cjrMc,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.XGR_CZY_DJXH) xgrMc
		  FROM BG_HYXM A,QY_ZZJG B
		  WHERE A.JGBM=B.JGBM 
		  	AND A.YXBZ='Y'  
		  <dynamic> 
			<isNotEmpty property="cjrCzyDjxh" prepend="and">
				A.CJR_CZY_DJXH = #cjrCzyDjxh#
			</isNotEmpty>
			<isNotEmpty property="zt" prepend="and">
				A.ZT LIKE #zt#
			</isNotEmpty>
			<isNotEmpty property="rqQ" prepend="AND">
		  		A.CJRQ >= TO_DATE(#rqQ#,'yyyy-MM-dd')
		  	</isNotEmpty>
		  	<isNotEmpty property="rqZ" prepend="AND">
		  		A.CJRQ &lt; TO_DATE(#rqZ#,'yyyy-MM-dd')+1
		  	</isNotEmpty>
		  </dynamic>
		  ORDER by A.HYXM_DJXH ASC
    </select>

	<select id="getBgHyxmRowCount" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		SELECT count(A.HYXM_DJXH) 
		  FROM BG_HYXM A 
		  WHERE A.YXBZ='Y' 
		  <dynamic> 
			<isNotEmpty property="cjrCzyDjxh" prepend="and">
				A.CJR_CZY_DJXH = #cjrCzyDjxh#
			</isNotEmpty>
			<isNotEmpty property="zt" prepend="and">
				A.ZT LIKE #zt#
			</isNotEmpty>
			<isNotEmpty property="rqQ" prepend="AND">
		  		A.CJRQ >= TO_DATE(#rqQ#,'yyyy-MM-dd')
		  	</isNotEmpty>
		  	<isNotEmpty property="rqZ" prepend="AND">
		  		A.CJRQ &lt; TO_DATE(#rqZ#,'yyyy-MM-dd')+1
		  	</isNotEmpty>
		  </dynamic>
    </select>
    <select id="selectBgHyxmFjList" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgHyxmDomain">
		SELECT A.HYXM_DJXH AS hyxmDjxh,
		       A.XH AS xh,
		       A.FJMC AS fjmc,
		       A.YXBZ AS yxbz
		  FROM BG_HYXM_FJ A 
		  WHERE A.YXBZ='Y' 
		  AND HYXM_DJXH=#hyxmDjxh#
    </select>
    
   <select id="getMaxFjxhByHyxmDjXh" parameterClass="java.util.Map" resultClass="Integer"> 
     	SELECT NVL(MAX(XH),0) FROM BG_HYXM_FJ WHERE HYXM_DJXH=#hyxmDjxh#
   </select>
</sqlMap>
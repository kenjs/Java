<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE sqlMap   
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"   
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="com.cy.bggl.dao.BusBgglBgtzggMapper">
	<select id="selectBgTzggPage" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgTzggDomain">
		SELECT A.TZGG_XH AS tzggXh,
		       A.JGBM AS jgbm,
		       B.JC AS jgmc,
		       A.BCZT_DM AS bcztDm,
		       A.ZT AS zt,
		       A.XJGXBZ AS xjgxbz,
		       A.CJR_CZY_DJXH AS cjrCzyDjxh,
		       A.CJRQ AS cjrq,
		       A.XGR_CZY_DJXH AS xgrCzyDjxh,
		       A.XGRQ AS xgrq,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.CJR_CZY_DJXH) cjrMc,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.XGR_CZY_DJXH) xgrMc
		  FROM BG_TZGG A ,QY_ZZJG B
		  WHERE A.JGBM=B.JGBM 
		  	AND A.YXBZ='Y' 
		  <dynamic> 
		  <isNotEmpty property="cjrCzyDjxh" prepend="and">
				A.CJR_CZY_DJXH = #cjrCzyDjxh#
			</isNotEmpty>
			<isNotEmpty property="zt" prepend="and">
				A.ZT LIKE #zt#
			</isNotEmpty>
			<isNotEmpty property="rqQ" prepend="AND">
		  		A.CJRQ >= TO_DATE(#rqQ#,'yyyy-MM-dd')
		  	</isNotEmpty>
		  	<isNotEmpty property="rqZ" prepend="AND">
		  		A.CJRQ &lt; TO_DATE(#rqZ#,'yyyy-MM-dd')+1
		  	</isNotEmpty>
		  </dynamic>
		  $orderStr$
    </select>
    
    <select id="selectBgTzggAll" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgTzggDomain">
		SELECT A.TZGG_XH AS tzggXh,
		       A.JGBM AS jgbm,
		       B.JC AS jgmc,
		       A.BCZT_DM AS bcztDm,
		       A.ZT AS zt,
		       A.XJGXBZ AS xjgxbz,
		       A.CJR_CZY_DJXH AS cjrCzyDjxh,
		       A.CJRQ AS cjrq,
		       A.XGR_CZY_DJXH AS xgrCzyDjxh,
		       A.XGRQ AS xgrq,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.CJR_CZY_DJXH) cjrMc,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.XGR_CZY_DJXH) xgrMc
		 FROM BG_TZGG A ,QY_ZZJG B
		  WHERE A.JGBM=B.JGBM 
		  	AND A.YXBZ='Y' 
		  <dynamic> 
		  	<isNotEmpty property="cjrCzyDjxh" prepend="and">
				A.CJR_CZY_DJXH = #cjrCzyDjxh#
			</isNotEmpty>
			<isNotEmpty property="zt" prepend="and">
				A.ZT LIKE #zt#
			</isNotEmpty>
			<isNotEmpty property="rqQ" prepend="AND">
		  		A.CJRQ >= TO_DATE(#rqQ#,'yyyy-MM-dd')
		  	</isNotEmpty>
		  	<isNotEmpty property="rqZ" prepend="AND">
		  		A.CJRQ &lt; TO_DATE(#rqZ#,'yyyy-MM-dd')+1
		  	</isNotEmpty>
		  </dynamic>
		  ORDER by A.TZGG_XH ASC
    </select>

	<select id="getBgTzggRowCount" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		SELECT count(A.TZGG_XH) 
		  FROM BG_TZGG A ,QY_ZZJG B
		  WHERE A.JGBM=B.JGBM 
		  	AND A.YXBZ='Y' 
		  <dynamic> 
		  	<isNotEmpty property="cjrCzyDjxh" prepend="and">
				A.CJR_CZY_DJXH = #cjrCzyDjxh#
			</isNotEmpty>
			<isNotEmpty property="zt" prepend="and">
				A.ZT LIKE #zt#
			</isNotEmpty>
			<isNotEmpty property="rqQ" prepend="AND">
		  		A.CJRQ >= TO_DATE(#rqQ#,'yyyy-MM-dd')
		  	</isNotEmpty>
		  	<isNotEmpty property="rqZ" prepend="AND">
		  		A.CJRQ &lt; TO_DATE(#rqZ#,'yyyy-MM-dd')+1
		  	</isNotEmpty>
		  </dynamic>
    </select>
    
    <select id="selectBgTzggFjList" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgTzggDomain">
		SELECT A.TZGG_XH AS tzggXh,
		       A.XH AS xh,
		       A.FJMC AS fjmc,
		       A.YXBZ AS yxbz
		  FROM BG_TZGG_FJ A 
		  WHERE A.YXBZ='Y' 
		  AND TZGG_XH=#tzggXh#
    </select>
    
   <select id="getMaxFjxhByTzggXh" parameterClass="java.util.Map" resultClass="Integer"> 
     	SELECT NVL(MAX(XH),0) FROM BG_TZGG_FJ WHERE TZGG_XH=#tzggXh#
   </select>
</sqlMap>
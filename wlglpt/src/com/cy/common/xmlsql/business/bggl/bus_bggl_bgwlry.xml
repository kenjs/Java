<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE sqlMap   
    PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"   
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="com.cy.bggl.dao.BusBgglBgwlryMapper">
	<select id="selectBgWlryPage" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgWlryDomain">
		SELECT A.WLRY_DJXH AS wlryDjxh,
		       A.WLRY_FLXH AS wlryFlxh,
		       A.XM AS xm,
		       A.DZ AS dz,
		       A.DH AS dh,
		       A.CZ AS cz,
		       A.SJ AS sj,
		       A.WZ AS wz,
		       A.YB AS yb,
		       A.DY AS dy,
		       A.BZ AS bz,
		       A.YXBZ AS yxbz,
		       A.CJR_CZY_DJXH AS cjrCzyDjxh,
		       A.CJRQ AS cjrq,
		       A.XGR_CZY_DJXH AS xgrCzyDjxh,
		       A.XGRQ AS xgrq,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.CJR_CZY_DJXH) AS cjrMc,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.XGR_CZY_DJXH) AS xgrMc,
		       B.FLMC AS flmc,
		       B.JGBM AS jgbm
		  FROM BG_WLRY A,BG_WLRY_FL B 
		  WHERE A.YXBZ='Y'
		  	and A.WLRY_FLXH=B.WLRY_FLXH
		  	and	B.JGBM=#jgbm#
		  <dynamic>
       		<isNotEmpty prepend="and" property="wlryFlxh">
       			A.WLRY_FLXH=#wlryFlxh#
       		</isNotEmpty>
       	 </dynamic>
       	 <dynamic>
       		<isNotEmpty prepend="and" property="xm">
       			A.XM like #xm#
       		</isNotEmpty>
       	 </dynamic> 
       	 <dynamic>
       		<isNotEmpty prepend="and" property="dz">
       			A.DZ like #dz#
       		</isNotEmpty>
       	 </dynamic>  

		  $orderStr$
    </select>
    
    <select id="selectBgWlryAll" parameterClass="java.util.Map"
		resultClass="com.cy.bggl.domain.BgWlryDomain">
		SELECT A.WLRY_DJXH AS wlryDjxh,
		       A.WLRY_FLXH AS wlryFlxh,
		       A.XM AS xm,
		       A.DZ AS dz,
		       A.DH AS dh,
		       A.CZ AS cz,
		       A.SJ AS sj,
		       A.WZ AS wz,
		       A.YB AS yb,
		       A.DY AS dy,
		       A.BZ AS bz,
		       A.YXBZ AS yxbz,
		       A.CJR_CZY_DJXH AS cjrCzyDjxh,
		       A.CJRQ AS cjrq,
		       A.XGR_CZY_DJXH AS xgrCzyDjxh,
		       A.XGRQ AS xgrq,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.CJR_CZY_DJXH) AS cjrMc,
		       (SELECT RY.MC from QY_RYDJ RY WHERE RY.CZY_DJXH=A.XGR_CZY_DJXH) AS xgrMc,
		       B.FLMC AS flmc
		  FROM BG_WLRY A,BG_WLRY_FL B 
		  WHERE A.YXBZ='Y'
		  	and A.WLRY_FLXH=B.WLRY_FLXH
		  	and	B.JGBM=#jgbm#
		  <dynamic>
       		<isNotEmpty prepend="and" property="wlryFlxh">
       			A.WLRY_FLXH=#wlryFlxh#
       		</isNotEmpty>
       	 </dynamic> 
       	 <dynamic>
       		<isNotEmpty prepend="and" property="xm">
       			A.XM like #xm#
       		</isNotEmpty>
       	 </dynamic> 
       	 <dynamic>
       		<isNotEmpty prepend="and" property="dz">
       			A.DZ like #dz#
       		</isNotEmpty>
       	 </dynamic>  

		  ORDER by A.WLRY_DJXH DESC
    </select>

	<select id="getBgWlryRowCount" parameterClass="java.util.Map"
		resultClass="java.lang.Integer">
		SELECT count(A.WLRY_DJXH) 
		  FROM BG_WLRY A,BG_WLRY_FL B 
		  WHERE A.YXBZ='Y'
		  	and A.WLRY_FLXH=B.WLRY_FLXH
		  	and	B.JGBM=#jgbm#
		  <dynamic>
       		<isNotEmpty prepend="and" property="wlryFlxh">
       			A.WLRY_FLXH=#wlryFlxh#
       		</isNotEmpty>
       	 </dynamic>
       	 <dynamic>
       		<isNotEmpty prepend="and" property="xm">
       			A.XM like #xm#
       		</isNotEmpty>
       	 </dynamic> 
       	 <dynamic>
       		<isNotEmpty prepend="and" property="dz">
       			A.DZ like #dz#
       		</isNotEmpty>
       	 </dynamic>   

    </select>
</sqlMap>